---
title: ' Effort Estimation'
author: "Doug Beare & Laurie Kell"
date: "25/05/2015"
output: slidy_presentation
---

## SHORT-TERM CONTRACT 
### A MODELING APPROACH TO ESTIMATE OVERALL ATLANTIC FISHING EFFORT BY TIME-AREA STRATA (EFFDIS)

## Objectives

Develop a robust statistical modeling approach to estimate overall Atlantic fishing effort stratified by flag/fleet, gear, area (5ºx5º degree square grid), year and month (starting in 1950).

Update the current EFFDIS estimations for longline gear (1950 to 2014) using the new approach, and then develop estimation procedures for baitboat and purse-seine with the appropriate effort units.  

## Outline

The SGECO Working group made a series of recommendations for improving EFFDIS, ie.

+ Considering seasonal and spatial patterns and their interactions 
+ Understanding how information from pecies composition can best be used in this context
+ Combining bait boat and purse-seine estimates with the long-line
+ Estimating uncertainty/variance 
+ Cross-validating using other relevant information where available, e.g. VMS data

## Overall workplan

+ Obtain all the relevant data and review the current methods for EFFDIS estimation 
+ Write documented R code to mimic the current procedure
+ Develop  ‘strawman’ methodologies for estimating fishing effort for a single fleet/flag country
+ Once a method is approved for one fleet the Contractor will then adapt it to other fleets to produce global estimates.  
+ Use an online SQL relational database linked to R-scripts

## Detailed workplan

+ Explore data for confounding (data catalogue)
+ Investigate the relationship between Task 1 and Task 2 data (Sum of products) for fleet combinations
+ Develop most appropriate multi-variate models (e.g. GLMs, GAMs) to interpolate data voids
+ Estimate variance/bias with jackknife
+ Test predictions using cross-validation methodology


## Confounding
```{r,include=FALSE}
library(rio)
library(maps)
library(mapdata)
source("/home/doug/effdis/R/yr.month.coverage.task2.f")
source("/home/doug/effdis/R/spatial.coverage.by.year.task2.f")
t2ceLL <- read.table("/home/doug/effdis/data/t2ceLL.csv",sep=",")
t1det9sp <- import("/home/doug/effdis/data/t1det_9sp.xlsx")
```
```{r temporal confounding Chinese Taipei,include=TRUE,echo=FALSE}
yr.month.coverage.task2.f(tdata=t2ceLL,which.flag='Chinese Taipei')
```

## 

```{r temporal confounding Japan,include=TRUE,echo=FALSE}
yr.month.coverage.task2.f(tdata=t2ceLL,which.flag='Japan')
```

## 

```{r spatial confounding China,include=TRUE,echo=FALSE}
library(maps)
spatial.coverage.by.year.task2.f(tdata=t2ceLL,which.flag='Chinese Taipei')
```

##

```{r spatial confounding by month Portugal, fig.width=8,include=TRUE,echo=FALSE}
source("/home/doug/effdis/R/spatial.coverage.by.month.task2.f")
spatial.coverage.by.month.task2.f()
```

##

```{r no of hooks reported by Taipei and Japan in task 2, fig.width=8,include=TRUE,echo=FALSE,message = FALSE, error=FALSE, warnings=FALSE}
source("/home/doug/effdis/R/effort.by.year.task2.f")
par(mfrow=c(2,1))
effort.by.year.task2.f(which.flag='Chinese Taipei')
effort.by.year.task2.f(which.flag='Japan')
```





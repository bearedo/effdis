---
title: Task 2 effort and catch data atlas for the AOTTP (bigeye, skipjack and yellowfin
  caught by long-line, purse-seine and bait-boat)
author: "Doug Beare"
date: "9 December 2015"
output: pdf_document
header-includes: \usepackage{tabularx}
subtitle: null
Grmd::docx_document:
  fig_caption: yes
  force_captions: yes
---
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=9, fig.height=10, fig.path='Figs/',
                      echo=FALSE, warning=FALSE, message=FALSE)
```

#Background 

The overall objective of the Atlantic Tuna Tagging Programme (AOTTP) is to contribute to food security and economic growth of the Atlantic developing coastal states by ensuring sustainable management of tropical tuna resources in the Atlantic Ocean
The specific objective of this programme is to provide evidence based scientific advices to developing costal states, and other Contracting Parties, to support the adoption of effective Conservation and Management Measures (CMMs) in the framework of the International Commission for the Conservations of Atlantic Tunas (ICCAT). This will be achieved through improving the estimation, derived from tag-recapture data, of key parameters for stock assessment analyses, i.e. growth, natural mortality, movements and stock structure, etc.



```{r attach libraries and connect to DB, include =F, echo=F,eval=T, message=FALSE,error=FALSE,warning=FALSE}
library(spatial)
library(sp)
library(doBy)
library(rgdal)
library(RODBC)
library(RColorBrewer)
library(ggplot2)
library(vmstools)
library(mgcv)
library(maps)
library(mapdata)
library(reshape2)
library(rgeos)
library(lattice)
library(pander)
library(kfigr)
library(effdisR)
chan <- odbcConnect("effdis-tuna-cc1", case="postgresql", believeNRows=FALSE)
```


```{r get ll data by flag,include=TRUE,echo=F, eval=T}
effort_type_by_flag_ll <- sqlQuery(chan, "SELECT flagname AS Flag, 
eff1type AS Effort_type, count(eff1type) as No_records
                 FROM t2ce_new
                 WHERE region ='AT' AND geargrpcode = 'LL' AND yearc = 2014
                 GROUP BY flagname, eff1type
                 ORDER BY flagname, eff1type, No_records;")
```


```{r get ps data by flag,include=TRUE,echo=F,eval=T}
effort_type_by_flag_ps <- sqlQuery(chan, "SELECT flagname AS Flag, 
eff1type AS Effort_type, count(eff1type) as No_records
                 FROM t2ce_new
                 WHERE region ='AT' AND geargrpcode = 'PS' AND yearc = 2014
                 GROUP BY flagname, eff1type
                 ORDER BY flagname, eff1type, No_records;")
```



```{r get bb data by flag,include=TRUE,echo=F,eval=T}
effort_type_by_flag_bb <- sqlQuery(chan, "SELECT flagname AS Flag, 
eff1type AS Effort_type, count(eff1type) as No_records
                 FROM t2ce_new
                 WHERE region ='AT' AND geargrpcode = 'BB' AND yearc = 2014
                 GROUP BY flagname, eff1type
                 ORDER BY flagname, eff1type, No_records;")
```


```{r get ll data for ten most important flags,include=TRUE,echo=F,eval=T}
ll <- sqlQuery(chan,"SELECT yearc AS year, trend, timeperiodid AS month, 
flagname, region, geargrpcode,lon,lat,longitude,latitude,quadid AS quad, squaretypecode AS square, catchunit, dsettype, eff1, eff1type
FROM t2ce_new
WHERE region ='AT' AND yearc > 2009 AND timeperiodid < 13 AND eff1type='NO.HOOKS' AND geargrpcode = 'LL' 
AND flagname IN ('Japan','Chinese Taipei','Brazil','Angola','EU.España','EU.Portugal','St. Vincent and Grenadines','Vanuatu','U.S.A.','Namibia') 
AND catchunit != '--' ;")
df <- data.frame(quad=ll$quad,lat=ll$lat,lon=ll$lon,square=ll$square)
df$square <- as.character(df$square)
ldf <- length(df$square)
df1<- data.frame(quad=rep(NA,ldf),lat=rep(NA,ldf),lon=rep(NA,ldf),square=rep(NA,ldf))
for(i in 1:length(df[,1]))
{df1[i,] <- latLon(x=df[i,])}
ll$longitude<- df1$lon
ll$latitude <- df1$lat

```


```{r get purse-seine data for select flags,include=TRUE,echo=F,eval=T}
ps <- sqlQuery(chan,"SELECT yearc AS year, trend, timeperiodid AS month, 
flagname, region, geargrpcode,lon,lat, longitude,latitude,quadid AS quad, squaretypecode AS square, catchunit, dsettype, eff1, eff1type
FROM t2ce_new
WHERE region ='AT' AND yearc > 2009 AND timeperiodid < 13 AND eff1type IN ('D.FISH','FISH.HOUR') 
AND geargrpcode = 'PS' AND flagname IN ('Belize','Côte D''Ivoire','EU.España','Guatemala','Guinée Rep.','Panama','Venezuela','Panama','EU.France','EU.Portugal','U.S.A.', 'Curaçao','EU.Netherlands','Maroc','Namibia' ) 
AND catchunit != '--' ;")
df <- data.frame(quad=ps$quad,lat=ps$lat,lon=ps$lon,square=ps$square)
df$square <- as.character(df$square)
ldf <- length(df$square)
df1<- data.frame(quad=rep(NA,ldf),lat=rep(NA,ldf),lon=rep(NA,ldf),square=rep(NA,ldf))
for(i in 1:length(df[,1]))
{df1[i,] <- latLon(x=df[i,])}
ps$longitude<- df1$lon
ps$latitude <- df1$lat
```



```{r get bait-boat data,include=TRUE,echo=F,eval=T}
bb <- sqlQuery(chan,"SELECT yearc AS year, trend, timeperiodid AS month, 
flagname, region, geargrpcode,lon,lat,longitude,latitude,quadid AS quad, squaretypecode AS square, catchunit, dsettype, eff1, eff1type
FROM t2ce_new
WHERE region ='AT' AND yearc > 2009 AND timeperiodid < 13 
AND geargrpcode = 'BB';")
df <- data.frame(quad=bb$quad,lat=bb$lat,lon=bb$lon,square=bb$square)
df$square <- as.character(df$square)
ldf <- length(df$square)
df1<- data.frame(quad=rep(NA,ldf),lat=rep(NA,ldf),lon=rep(NA,ldf),square=rep(NA,ldf))
for(i in 1:length(df[,1]))
{df1[i,] <- latLon(x=df[i,])}
bb$longitude<- df1$lon
bb$latitude <- df1$lat

```



```{r extract kg bigeye caught by selected flags from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE,eval=T}
bet <- sqlQuery(chan,"SELECT yearc AS year, trend,quadid as quad, squaretypecode AS square,
timeperiodid AS month, flagname, region, geargrpcode,lon,lat,longitude,latitude, 
catchunit, dsettype, eff1, eff1type, bet as measured_catch
FROM t2ce_new
WHERE region ='AT' AND timeperiodid < 13 AND yearc > 2009 AND 
geargrpcode IN ('LL','PS','BB') AND catchunit != '--' ;")
bet$species <- 'bet'
df <- data.frame(quad=bet$quad,lat=bet$lat,lon=bet$lon,square=bet$square)
df$square <- as.character(df$square)
ldf <- length(df$square)
df1<- data.frame(quad=rep(NA,ldf),lat=rep(NA,ldf),lon=rep(NA,ldf),square=rep(NA,ldf))
for(i in 1:ldf){df1[i,] <- latLon(x=df[i,])}
bet$longitude<- df1$lon
bet$latitude <- df1$lat

```



```{r extract kg skipjack caught by selected flags from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE,eval=T}
skj<- sqlQuery(chan,"SELECT yearc AS year, trend,quadid as quad, squaretypecode AS square,
timeperiodid AS month, flagname, region, geargrpcode,lon,lat,longitude,latitude, 
catchunit, dsettype, eff1, eff1type, skj as measured_catch
FROM t2ce_new
WHERE region ='AT' AND timeperiodid < 13 AND yearc > 2009 AND 
geargrpcode IN ('LL','PS','BB') AND catchunit != '--' ;")
skj$species <- 'skj'

df <- data.frame(quad=skj$quad,lat=skj$lat,lon=skj$lon,square=skj$square)
df$square <- as.character(df$square)
ldf <- length(df$square)
df1<- data.frame(quad=rep(NA,ldf),lat=rep(NA,ldf),lon=rep(NA,ldf),square=rep(NA,ldf))
for(i in 1:ldf){df1[i,] <- latLon(x=df[i,])}
skj$longitude<- df1$lon
skj$latitude <- df1$lat

```



```{r extract kg yellowfin caught by selected flags from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE,eval=T}
yft<- sqlQuery(chan,"SELECT yearc AS year, trend,quadid as quad, squaretypecode AS square,
timeperiodid AS month, flagname, region, geargrpcode,lon,lat,longitude,latitude, 
catchunit, dsettype, eff1, eff1type, yft as measured_catch
FROM t2ce_new
WHERE region ='AT' AND timeperiodid < 13 AND yearc > 2009 AND 
geargrpcode IN ('LL','PS','BB') AND catchunit != '--' ;")
yft$species <- 'yft'
df <- data.frame(quad=yft$quad,lat=yft$lat,lon=yft$lon,square=yft$square)
df$square <- as.character(df$square)
ldf <- length(df$square)
df1<- data.frame(quad=rep(NA,ldf),lat=rep(NA,ldf),lon=rep(NA,ldf),square=rep(NA,ldf))
for(i in 1:ldf){df1[i,] <- latLon(x=df[i,])}
yft$longitude<- df1$lon
yft$latitude <- df1$lat

```



#Task 2 data for long-line in the Atlantic


*Table 1. Effort type sampling by flag for longline in EFFDIS Task II database in 2014*
```{r make table for ll data by flag,include=TRUE,echo=FALSE}
pander(effort_type_by_flag_ll)
```

##Distribution of Task 2 long-line data

```{r spatial sampling Brazil,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(2,2,2,2))
spatial.coverage.by.year.task2(tdata=ll,
        start.year=2011,end.year=2014,which.gear='LL',which.flag='Brazil')
```

**Figure 1** *Spatial distribution of data: Brazilian long-liners between 2011 and 2014*


```{r spatial sampling Chinese Taipei, include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(2,2,2,2))
spatial.coverage.by.year.task2(tdata=ll,
        start.year=2011,end.year=2014,which.gear='LL',which.flag='Chinese Taipei')
```

**Figure 2.** *Spatial distribution of data: Chinese Taipei long-liners between 2011 and 2014*


```{r spatial sampling EU. Spain, include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(2,2,2,2))
spatial.coverage.by.year.task2(tdata=ll,
        start.year=2011,end.year=2014,which.gear='LL',which.flag='EU.España')
```

**Figure 3.** *Spatial distribution of data: spanish long-liners between 2011 and 2014*

```{r spatial sampling St Vincent and Grenadines, include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(2,2,2,2))
spatial.coverage.by.year.task2(tdata=ll,
        start.year=2011,end.year=2014,which.gear='LL',which.flag="St. Vincent and Grenadines")
```

**Figure 4.** *Spatial distribution of data: St Vincent and Grenadines long-liners between 2011 and 2014*


```{r spatial sampling USA, include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(2,2,2,2))
spatial.coverage.by.year.task2(tdata=ll,
        start.year=2011,end.year=2014,which.gear='LL',which.flag="U.S.A.")
```

**Figure 5.** *Spatial distribution of data: USA long-liners between 2011 and 2014*



##Long-line effort (NO.HOOKS) distribution


```{r no of hooks shot by Japan in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(1,1))
three.d.effort.by.year(tdata=ll,which.year=2014,
                         which.flag='Japan',scaling.f=10000,effort.type='NO.HOOKS')  
```


**Figure 6.** *Number of hooks set by Japanese fleet (Task II only) in 2014*

```{r no of hooks shot by Chinese Taipei in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
three.d.effort.by.year(tdata=ll,which.year=2014,
                         which.flag="Chinese Taipei",scaling.f=10000,gridx=5,gridy=5,
                         effort.type='NO.HOOKS',which.gear='LL')  
```

**Figure 7.** *Number of hooks set by Chinese Taipei (Task II only) in 2014*



##Bigeye caught by long-line (2014).

```{r weight of bigeye caught in Atlantic in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(2,2),mar=c(2,1,2,1))
three.d.catch.by.year(tdata=bet,which.year=2014,which.gear='LL',gridx=5,gridy=5,which.species='bet',which.flag='Chinese Taipei',scaling.f=10,catchunit='kg')  
three.d.catch.by.year(tdata=bet,which.year=2014,
                        which.gear='LL',which.species='bet',which.flag='Japan',scaling.f=10,catchunit='nr')
three.d.catch.by.year(tdata=bet,which.year=2014,
                        which.gear='LL',which.species='bet',gridx=5,gridy=5,which.flag='EU.Portugal',scaling.f=10,catchunit='kg')  
three.d.catch.by.year(tdata=bet,which.year=2014,
                        which.gear='LL',which.species='bet',gridx=5,gridy=5,which.flag='Korea Rep.',scaling.f=10,catchunit='kg')
```

**Figure 8.** *Bigeye tuna caught by long-line by Chinese Taipei, Japan, EU. Portugal, and Korean Republic*


##Skipjack caught by long-line (2014).

```{r weight of skipjack caught by location by longline in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(2,1),mar=c(2,1,2,1))
three.d.catch.by.year(tdata=skj,which.year=2014,which.gear='LL',which.species='skj',which.flag='Chinese Taipei',scaling.f=1,catchunit='kg')  
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='LL',which.species='skj',which.flag='Japan',scaling.f=1,catchunit='nr')
```

**Figure 9.** *Skipjack tuna caught by long-line by Chinese Taipei, Japan*


##Yellowfin caught by long-line (2014).


```{r weight of yellowfin caught by location by longline in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(3,3),mar=c(2,2,2,2))
three.d.catch.by.year(tdata=yft,which.year=2014,which.gear='LL',which.species='yft',which.flag='Chinese Taipei',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='LL',which.species='yft',which.flag='Japan',scaling.f=100,catchunit='nr')

three.d.catch.by.year(tdata=yft,which.year=2014,which.gear='LL',which.species='yft',which.flag='U.S.A.',scaling.f=100,catchunit='nr')  
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='LL',which.species='yft',which.flag='Korea Rep.',scaling.f=100,catchunit='kg')

three.d.catch.by.year(tdata=yft,which.year=2014,which.gear='LL',which.species='yft',which.flag='Canada',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='LL',which.species='yft',which.flag='China PR',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='LL',which.species='yft',which.flag='Mexico',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='LL',which.species='yft',which.flag='Vanuatu',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='LL',which.species='yft',which.flag='Venezuela',scaling.f=100,catchunit='kg')



```

**Figure 10.** *Yellowfin tuna caught by long-line by selected flags*


#Task 2 purse-seine data for the Atlantic


*Table 2. Effort type sampling by flag for purse-seiners in EFFDIS Task II database in 2014*
```{r make table for ps data by flag,include=TRUE,echo=FALSE}
pander(effort_type_by_flag_ps)
```

##Distribution of Task 2 purse-seine data


```{r plot distribution of spanish purse-seine data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=ps,start.year=2011,end.year=2014,
                                 which.gear='PS',which.flag='EU.España')
```

**Figure 11.** *Distribution of data: spanish purse-seiners between 2011 and 2014*


```{r plot distribution of belize purse-seine data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=ps,start.year=2011,end.year=2014,
                                 which.gear='PS',which.flag='Belize')
```

**Figure 12.** *Distribution of data: Belize purse-seiners between 2011 and 2014*



```{r plot distribution of ivorian purse-seine data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=ps,start.year=2011,end.year=2014,
                                 which.gear='PS',which.flag="Côte D'Ivoire")
```

**Figure 13.** *Distribution of data: Ivorian purse-seiners between 2011 and 2014*


```{r plot distribution of guatemalan purse-seine data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=ps,start.year=2011,end.year=2014,
                                 which.gear='PS',which.flag="Guatemala")
```

**Figure 14.** *Distribution of data: Guatemalan purse-seiners between 2011 and 2014*


```{r plot distribution of guinean purse-seine data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=ps,start.year=2011,end.year=2014,
                                 which.gear='PS',which.flag="Guinée Rep.")
```

**Figure 15.** *Distribution of data: Guinean rep. purse-seiners between 2011 and 2014*


```{r plot distribution of panama purse-seine data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=ps,start.year=2011,end.year=2014,
                                 which.gear='PS',which.flag="Panama")
```

**Figure 16.** *Distribution of data: Panama purse-seiners between 2011 and 2014*


```{r plot distribution of french purse-seine data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=ps,start.year=2011,end.year=2014,
                                 which.gear='PS',which.flag="EU.France")
```

**Figure 17.** *Distribution of data: French purse-seiners between 2011 and 2014*


```{r plot distribution of venezuelan purse-seine data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=ps,start.year=2011,end.year=2014,
                                 which.gear='PS',which.flag="Venezuela")
```

**Figure 18.** *Distribution of data: Venezuelan purse-seiners between 2011 and 2014*


##Purse-seine effort (FISH.HOUR, D.FISH) distribution in the Atlantic (2014)


```{r no of fishing hours by Spain in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(1,1))
three.d.effort.by.year(tdata=ps,which.year=2014,
                         which.flag='EU.España',gridx=1,gridy=1,
                         scaling.f=2,effort.type='FISH.HOUR',which.gear='PS')  
```

**Figure 19.** *Hours fished reported by spanish purse-seiners (Task II only)  in 2014*

```{r no of fishing hours by Panama in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
three.d.effort.by.year(tdata=ps,which.year=2014,
                         which.flag='Panama',
                         gridx=1,gridy=1,scaling.f=1,effort.type='FISH.HOUR',which.gear='PS')  
```

**Figure 20.** *Hours fished reported by Panamanian purse-seiners (Task II only) 2014*


```{r no of fishing hours by Belize in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
three.d.effort.by.year(tdata=ps,which.year=2014,
                         which.flag='Belize',
                         gridx=1,gridy=1,scaling.f=1,effort.type='D.FISH',which.gear='PS')  
```

**Figure 21.** *Days fished reported by Belize purse-seiners (Task II only) 2014*


```{r no of fishing hours by Guatemala in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
three.d.effort.by.year(tdata=ps,which.year=2014,
                         which.flag='Guatemala',
                         gridx=1,gridy=1,scaling.f=1,effort.type='FISH.HOUR',which.gear='PS')  
```

**Figure 22.** *Hours fished reported by Belize purse-seiners (Task II only) 2014*

```{r no of fishing hours by Ivory Coast in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
three.d.effort.by.year(tdata=ps,which.year=2014,
                         which.flag="Côte D'Ivoire",
                         gridx=1,gridy=1,scaling.f=1,effort.type='FISH.HOUR',which.gear='PS')  
```

**Figure 23.** *Hours fished reported by ivorian purse-seiners (Task II only) 2014*


```{r no of fishing hours by Venezuela in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
three.d.effort.by.year(tdata=ps,which.year=2014,
                         which.flag="Venezuela",
                         gridx=1,gridy=1,scaling.f=1,effort.type='D.FISH',which.gear='PS')  
```

**Figure 24.** *Days fished reported by Venezuelan purse-seiners (Task II only) 2014*


```{r no of fishing hours by Curucao in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
three.d.effort.by.year(tdata=ps,which.year=2014,
                         which.flag="Curaçao",
                         gridx=1,gridy=1,scaling.f=1,effort.type='FISH.HOUR',which.gear='PS')  
```

**Figure 25.** *Hours fished reported by Curucao purse-seiners (Task II only) 2014*



```{r no of fishing hours by Guinee in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
three.d.effort.by.year(tdata=ps,which.year=2014,
                         which.flag="Guinée Rep.",
                         gridx=1,gridy=1,scaling.f=1,effort.type='FISH.HOUR',which.gear='PS')  
```

**Figure 26.** *Hours fished reported by Guinean purse-seiners (Task II only) 2014*


##Bigeye caught by purse-seine (2014).

```{r weight of bigeye caught by location by purse-seine in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(2,2),mar=c(3,3,3,3))
three.d.catch.by.year(tdata=bet,which.year=2014,which.gear='PS',gridx=1,gridy=1,which.species='bet',which.flag='EU.France',scaling.f=10,catchunit='kg')  
three.d.catch.by.year(tdata=bet,which.year=2014,
                        which.gear='PS',which.species='bet',gridx=1,gridy=1,which.flag='EU.España',scaling.f=10,catchunit='kg')
three.d.catch.by.year(tdata=bet,which.year=2014,
                        which.gear='PS',which.species='bet',gridx=1,gridy=1,which.flag='Venezuela',scaling.f=10,catchunit='kg')  
three.d.catch.by.year(tdata=bet,which.year=2014,
                        which.gear='PS',which.species='bet',gridx=1,gridy=1,which.flag='Panama',scaling.f=10,catchunit='kg')
```

**Figure 27.** *Bigeye tuna caught by purse seine by France, Spain, Venezuela, and Panama*

##Skipjack caught by purse-seine.

```{r weight of skipjack caught by location by purse-seine in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(3,3),mar=c(2,2,2,2))
three.d.catch.by.year(tdata=skj,which.year=2014,which.gear='PS',gridx=1,gridy=1,which.species='skj',which.flag='EU.France',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='PS',which.species='skj',gridx=1,gridy=1,which.flag='EU.España',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='PS',which.species='skj',gridx=1,gridy=1,which.flag='Venezuela',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='PS',which.species='skj',gridx=1,gridy=1,which.flag='Panama',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='PS',which.species='skj',gridx=1,gridy=1,which.flag='Belize',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='PS',which.species='skj',gridx=1,gridy=1,which.flag='Guatemala',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='PS',which.species='skj',gridx=1,gridy=1,which.flag="Côte D'Ivoire",scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='PS',which.species='skj',gridx=1,gridy=1,which.flag="Curaçao",scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='PS',which.species='skj',gridx=1,gridy=1,which.flag="Guinée Rep.",scaling.f=100,catchunit='kg')


```

**Figure 28 .** *Skipjack caught by purse-seine by selected nations*

##Yellowfin caught by purse-seine.


```{r yellowfin caught by location by purse-seine in 2014 from task 2 part 1,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(2,2),mar=c(2,2,2,2))
three.d.catch.by.year(tdata=yft,which.year=2014,which.gear='PS',gridx=1,gridy=1,which.species='yft',which.flag='EU.France',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='PS',which.species='yft',gridx=1,gridy=1,which.flag='EU.España',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='PS',which.species='yft',gridx=1,gridy=1,which.flag='Venezuela',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='PS',which.species='yft',gridx=1,gridy=1,which.flag='Panama',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='PS',which.species='yft',gridx=1,gridy=1,which.flag='Belize',scaling.f=100,catchunit='kg')
```

**Figure 29.** *Yellowfin caught by purse-seine by Spain, Venezuela, Panama, and Belize*



```{r yellowfin caught by location by purse-seine in 2014 from task 2 part 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(2,2),mar=c(2,2,2,2))
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='PS',which.species='yft',gridx=1,gridy=1,which.flag='Guatemala',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='PS',which.species='yft',gridx=1,gridy=1,which.flag="Côte D'Ivoire",scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='PS',which.species='yft',gridx=1,gridy=1,which.flag="Curaçao",scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='PS',which.species='yft',gridx=1,gridy=1,which.flag="Guinée Rep.",scaling.f=100,catchunit='kg')
```

**Figure 30.** *Yellowfin caught by purse-seine by Guatemala, Ivory Coast, Curacao, and Guinea*



#Task 2 bait-boat data for The Atlantic


*Table 3. Effort type sampling by flag for purse-seiners in EFFDIS Task II database in 2014*
```{r make table for bb data by flag,include=TRUE,echo=FALSE}
pander(effort_type_by_flag_bb)
```

##Distribution of Task 2 bait-boat data


```{r plot distribution of spanish bait-boat data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=bb,start.year=2011,end.year=2014,
                                 which.gear='BB',which.flag='EU.España')
```

**Figure 31.** *Distribution of data: Spanish registered bait-boats between 2011 and 2014*


```{r plot distribution of Brazil bait-boat data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=bb
                               ,start.year=2011,end.year=2014,
                                 which.gear='BB',which.flag='Brazil')
```
**Figure 32.** *Distribution of data: Brazilian bait-boats between 2011 and 2014*


```{r plot distribution of french baitboat data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=bb,start.year=2011,end.year=2014,
                                 which.gear='BB',which.flag="EU.France")
```

**Figure 33.** *Distribution of data: French bait-boats between 2011 and 2014*

```{r plot distribution of portuguese baitboat data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=bb,start.year=2011,end.year=2014,
                                 which.gear='BB',which.flag="EU.Portugal")
```

**Figure 34.** *Distribution of data: Portuguese bait-boats between 2011 and 2014*


```{r plot distribution of senegalese bait-boat data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(1,1,2,1),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=bb,start.year=2011,end.year=2014,
                                 which.gear='BB',which.flag="Senegal")

```

**Figure 35.** *Distribution of data: Senegalese bait-boats between 2011 and 2014*


```{r plot distribution of south african bait-boat data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(2,2,2,2),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=bb,start.year=2011,end.year=2014,
                                 which.gear='BB',which.flag="South Africa")
```

**Figure 36.** *Distribution of data: South African bait-boats between 2011 and 2014*


```{r plot distribution of ghanaian bait-boats data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(2,2,2,2),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=bb,start.year=2011,end.year=2014,
                                 which.gear='BB',which.flag="Ghana")
```

**Figure 37.** *Distribution of data: Ghanaian bait-boats between 2011 and 2014*


```{r plot distribution of Venezuelan bait-boat data,include=TRUE,echo=F}
par(mfrow=c(2,2),mar=c(2,2,2,2),oma=c(3,3,3,3))
spatial.coverage.by.year.task2(tdata=bb,start.year=2011,end.year=2014,
                                 which.gear='BB',which.flag="Venezuela")
```

**Figure 38.** *Distribution of data: Venezuelan bait-boats between 2011 and 2014*


##Bigeye caught by bait-boat (2014).


```{r weight of bigeye caught by location in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(2,3),mar=c(2,2,2,2))
three.d.catch.by.year(tdata=bet,which.year=2014,which.gear='BB',gridx=1,gridy=1,which.species='bet',which.flag='EU.France',scaling.f=10,catchunit='kg')  
three.d.catch.by.year(tdata=bet,which.year=2014,
                        which.gear='BB',which.species='bet',gridx=1,gridy=1,which.flag='EU.España',scaling.f=10,catchunit='kg')
three.d.catch.by.year(tdata=bet,which.year=2014,
                        which.gear='BB',which.species='bet',gridx=1,gridy=1,which.flag='Venezuela',scaling.f=10,catchunit='kg')  
three.d.catch.by.year(tdata=bet,which.year=2014,which.gear='BB',which.species='bet',gridx=1,gridy=1,which.flag='South Africa',scaling.f=10,catchunit='kg')

three.d.catch.by.year(tdata=bet,which.year=2014,which.gear='BB',which.species='bet',gridx=1,gridy=1,which.flag='Senegal',scaling.f=10,catchunit='kg')

```

**Figure 39.** *Bigeye caught by selected nations by bait-boat in 2014*


##Skipjack caught by bait-boat in 2014.



```{r skipjack caught by location in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(2,3),mar=c(2,2,2,2))
three.d.catch.by.year(tdata=skj,which.year=2014,which.gear='BB',gridx=1,gridy=1,which.species='skj',which.flag='EU.France',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='BB',which.species='skj',gridx=1,gridy=1,which.flag='EU.España',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=skj,which.year=2014,
                        which.gear='BB',which.species='skj',gridx=1,gridy=1,which.flag='Senegal',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=skj,which.year=2014,which.gear='BB',which.species='skj',gridx=1,gridy=1,which.flag='South Africa',scaling.f=10,catchunit='kg')

three.d.catch.by.year(tdata=skj,which.year=2014,which.gear='BB',which.species='skj',gridx=1,gridy=1,which.flag='Venezuela',scaling.f=10,catchunit='kg')

three.d.catch.by.year(tdata=skj,which.year=2014,which.gear='BB',which.species='skj',gridx=1,gridy=1,which.flag='Brazil',scaling.f=10,catchunit='kg')

```

**Figure 40.** *Skipjack caught by bait-boat by 6 nations in 2014*


##Yellowfin caught by bait-boat in 2014.

```{r yellowfin caught by baitboat by location in 2014 from task 2,include=TRUE,echo=F,message = FALSE, error=FALSE, warnings=FALSE}
par(mfrow=c(2,3),mar=c(2,2,2,2))
three.d.catch.by.year(tdata=yft,which.year=2014,which.gear='BB',gridx=1,gridy=1,which.species='yft',which.flag='EU.France',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='BB',which.species='yft',gridx=1,gridy=1,which.flag='EU.España',scaling.f=100,catchunit='kg')
three.d.catch.by.year(tdata=yft,which.year=2014,
                        which.gear='BB',which.species='yft',gridx=1,gridy=1,which.flag='Senegal',scaling.f=100,catchunit='kg')  
three.d.catch.by.year(tdata=yft,which.year=2014,which.gear='BB',which.species='yft',gridx=1,gridy=1,which.flag='South Africa',scaling.f=100,catchunit='kg')

three.d.catch.by.year(tdata=yft,which.year=2014,which.gear='BB',which.species='yft',gridx=1,gridy=1,which.flag='Venezuela',scaling.f=100,catchunit='kg')

three.d.catch.by.year(tdata=yft,which.year=2014,which.gear='BB',which.species='yft',gridx=1,gridy=1,which.flag='Brazil',scaling.f=100,catchunit='kg')


```

**Figure 41.** *Yellowfin tuna caught by bait-boat by 6 nations*






























